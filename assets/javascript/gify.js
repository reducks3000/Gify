// animals Array
let animals = ["Dogs","Kitten","Fish","Dragon"];

function displayGif() {
    let animals = $(this).attr("data-name");
    let queryUrl = "https://api.giphy.com/v1/gifs/search?q=" + animals + "&api_key=dc6zaTOxFJmzC&limit=10";

    // Ajax call
    $.ajax({ url: queryUrl, method: "GET"}).done(function(response) {
        // Empty's div holding previous Gifs
        $('.gifDump').empty();

        for (let i = 0; i < response.data.length; i++) {
            // variables to add HTML elements and standardize images generated by buttons
            let gifDiv     = $('<div class="gifDiv">');
            let rating     = response.data[i].rating;
            let ratingDiv  = $('<p>').html("Rating: " + rating);
            let animated   = response.data[i].images.fixed_height.url;
            let still      = response.data[i].images.fixed_height_still.url;
            let gifImg     = $('<img class="gImage">');
            
            // Defaulting gifs to still
            gifImg.attr('src', still);
            gifImg.attr('data-still', still);
            gifImg.attr('data-animate', animated);
            gifImg.attr('data-state', 'still')
            
            // shows ratings for gifs
            gifDiv.append(ratingDiv);
            gifDiv.prepend(gifImg);
            $('.gifDump').prepend(gifDiv);
        }
    });
};

// Onclick function to animate/pause gifs
$('.gifDump').on("click", ".gImage", function() {

    let state = $(this).attr('data-state');
    // If state = still, on click will animate the gif
    if (state == 'still') {
        $(this).attr('src', $(this).data('animate'));
        $(this).attr('data-state', 'animate');}
    // Otherwise, if state != still, gif will pause on click   
    else {
        $(this).attr('src', $(this).data('still'));
        $(this).attr('data-state', 'still');
    }
});

// New buttons function
function renderButtons() {
  $(".buttons").empty();
  // Verifying buttons
  for (let i = 0; i < animals.length; i++) {
    let addButton = $('<button class="button">');
    addButton.addClass("animals");
    addButton.attr("data-name", animals[i]);
    addButton.html(animals[i]);

    // Appends new buttons to the end of the list of existing buttons
    $(".buttons").append(addButton);
  }
};

// New button created when field has a value entered and then cleared after confirming
$(".add-gif").on("click", function(event){
    event.preventDefault();
    let gifs = $(".gif-name").val().trim();
    animals.push(gifs);
    $(".gif-name").val("");
    renderButtons();
});

// Calls the buttons to be created in the class 'animals'
$(document).on("click", ".animals", displayGif);
renderButtons();